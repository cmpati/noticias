(()=>{(function(){let i=document.getElementById("searchInput"),s=document.getElementById("searchResults"),o=document.getElementById("searchStatus"),f,u=[],d=window.siteBaseURL||"/",y=d==="/"||d.endsWith("/")?d:d+"/";async function g(){try{console.log("Iniciando initSearch()..."),o.textContent="Carregando \xEDndice de not\xEDcias...";let e=(y+"search-index.json").replace(/\/\//g,"/");console.log(`Tentando buscar ${r(e)}`);let n=await fetch(e);if(console.log("Resposta do fetch:",n),!n.ok){console.error(`Falha ao carregar o \xEDndice: ${n.status} ${n.statusText} em ${e}`);let t=await n.text();throw console.error("Conte\xFAdo da resposta do erro:",t),s.innerHTML=`<p class="text-danger">Erro ${n.status} ao buscar o \xEDndice de not\xEDcias em <code>${r(e)}</code>. Verifique o console para mais detalhes e se a baseURL no config.toml est\xE1 correta.</p>`,o.textContent="Erro ao carregar a busca.",new Error(`Falha ao carregar o \xEDndice: ${n.status} ${n.statusText}`)}if(console.log("Tentando converter resposta para JSON..."),u=await n.json(),console.log("Documentos carregados:",u.length,"documentos."),u.length===0){console.warn("Nenhum documento encontrado no search-index.json. A busca n\xE3o funcionar\xE1."),o.textContent="Nenhum item encontrado para buscar.";return}console.log("Objeto lunr ANTES de qualquer 'use':",typeof lunr,lunr),console.log("lunr.stemmerSupport:",typeof lunr.stemmerSupport),console.log("lunr.pt:",typeof lunr.pt),typeof lunr<"u"&&typeof lunr.pt<"u"&&typeof lunr.use=="function"?(lunr.use(lunr.pt),console.log("Stemmer em Portugu\xEAs (lunr.pt) aplicado via lunr.use().")):(console.warn("N\xE3o foi poss\xEDvel aplicar lunr.pt via lunr.use(). Verifica\xE7\xF5es:"),typeof lunr>"u"?console.error("-> lunr N\xC3O est\xE1 definido!"):typeof lunr.use!="function"?console.error("-> lunr.use N\xC3O \xE9 uma fun\xE7\xE3o!",lunr):typeof lunr.pt>"u"&&console.error("-> lunr.pt N\xC3O est\xE1 definido!",lunr)),console.log("Inicializando Lunr com documentos..."),f=lunr(function(){typeof lunr<"u"&&typeof lunr.pt<"u"&&typeof this.use=="function"&&(this.use(lunr.pt),console.log("Stemmer lunr.pt aplicado dentro do construtor do \xEDndice.")),this.ref("permalink"),this.field("title",{boost:10}),this.field("summary",{boost:5}),this.field("content_preview"),this.field("categories",{boost:3}),this.field("tags",{boost:3}),this.field("section"),u.forEach((t,p)=>{if(typeof t.permalink>"u"||t.permalink===null){console.warn(`Documento ${p} ('${t.title||"Sem T\xEDtulo"}') n\xE3o tem permalink e n\xE3o ser\xE1 adicionado.`);return}this.add(t)})}),console.log("\xCDndice Lunr criado."),o.textContent="\xCDndice carregado. Pronto para buscar.";let c=new URLSearchParams(window.location.search).get("q");c&&(i.value=c),i.value.trim().length>0&&h()}catch(e){console.error("ERRO DETALHADO em initSearch():",e),o&&(o.textContent="Erro cr\xEDtico ao carregar a busca."),s&&s.innerHTML.trim()===""&&(s.innerHTML='<p class="text-danger">N\xE3o foi poss\xEDvel carregar a funcionalidade de busca. Verifique o console para detalhes.</p>')}}function h(){if(!f){o.textContent="Aguarde, o \xEDndice de busca ainda est\xE1 carregando...";return}let e=i.value.trim();if(s.innerHTML="",e.length<2){o.textContent=e.length>0?"Digite pelo menos 2 caracteres.":"Digite algo para iniciar a busca.";return}o.textContent=`Buscando por "${r(e)}"...`;try{let l=e.split(/\s+/).filter(t=>t.length>0).map(t=>t+"* "+t).join(" "),c=f.search(l);if(c.length>0){o.textContent=`${c.length} resultado(s) encontrado(s) para "${r(e)}":`;let t=document.createElement("ul");t.classList.add("list-group","list-group-flush","mt-3"),c.forEach(p=>{let a=u.find(m=>m.permalink===p.ref);if(a){let m=document.createElement("li");m.classList.add("list-group-item"),m.innerHTML=`
                            <h5 class="mb-1"><a href="${a.permalink}" class="text-decoration-none">${r(a.title)}</a></h5>
                            <p class="mb-1 small text-muted">${r(a.date)} ${a.section?`<em>(${r(a.section)})</em>`:""}</p>
                            <p class="mb-1 search-summary small">${r(a.summary)||"Sem resumo dispon\xEDvel."}</p>
                            ${a.categories&&a.categories.length>0?`<p class="mb-0 small"><strong>Categorias:</strong> ${a.categories.map(x=>r(x)).join(", ")}</p>`:""}
                        `,t.appendChild(m)}}),s.appendChild(t)}else o.textContent=`Nenhum resultado encontrado para "${r(e)}".`}catch(n){console.error("Erro na busca Lunr:",n),o.textContent="Ocorreu um erro ao realizar a busca.",s.innerHTML='<p class="text-danger">Ocorreu um erro durante a busca. Tente novamente.</p>'}}function r(e){return typeof e!="string"?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function b(e,n){let l;return function(...t){let p=()=>{clearTimeout(l),e(...t)};clearTimeout(l),l=setTimeout(p,n)}}i&&s&&o?(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g(),i.addEventListener("keyup",b(h,300))):console.error("Elementos da interface de busca (searchInput, searchResultsContainer, ou searchStatus) n\xE3o foram encontrados no DOM.")})();})();
