(()=>{(function(){let s=document.getElementById("searchInput"),c=document.getElementById("searchResults"),t=document.getElementById("searchStatus"),d,l=[];async function f(){try{console.log("Iniciando initSearch()..."),t.textContent="Carregando \xEDndice de not\xEDcias...",console.log("Tentando buscar /search-index.json");let e=await fetch("/search-index.json");if(console.log("Resposta do fetch:",e),!e.ok){console.error(`Falha ao carregar o \xEDndice: ${e.status} ${e.statusText}`);let n=await e.text();throw console.error("Conte\xFAdo da resposta do erro:",n),new Error(`Falha ao carregar o \xEDndice: ${e.status} ${e.statusText}`)}if(console.log("Tentando converter resposta para JSON..."),l=await e.json(),console.log("Documentos carregados:",l.length,"documentos."),l.length===0){console.warn("Nenhum documento encontrado no search-index.json. A busca n\xE3o funcionar\xE1."),t.textContent="Nenhum item encontrado para buscar.";return}console.log("Objeto lunr ANTES de qualquer 'use':",typeof lunr,lunr),console.log("lunr.stemmerSupport:",typeof lunr.stemmerSupport),console.log("lunr.pt:",typeof lunr.pt),typeof lunr<"u"&&typeof lunr.pt<"u"&&typeof lunr.use=="function"?(lunr.use(lunr.pt),console.log("Stemmer em Portugu\xEAs (lunr.pt) aplicado via lunr.use().")):(console.warn("N\xE3o foi poss\xEDvel aplicar lunr.pt via lunr.use(). Verifica\xE7\xF5es:"),typeof lunr>"u"?console.error("-> lunr N\xC3O est\xE1 definido!"):typeof lunr.use!="function"?console.error("-> lunr.use N\xC3O \xE9 uma fun\xE7\xE3o!",lunr):typeof lunr.pt>"u"&&console.error("-> lunr.pt N\xC3O est\xE1 definido!",lunr)),console.log("Inicializando Lunr com documentos..."),d=lunr(function(){typeof lunr<"u"&&typeof lunr.pt<"u"&&typeof this.use=="function"&&(this.use(lunr.pt),console.log("Stemmer lunr.pt aplicado dentro do construtor do \xEDndice.")),this.ref("permalink"),this.field("title",{boost:10}),this.field("summary",{boost:5}),this.field("content_preview"),this.field("categories",{boost:3}),this.field("tags",{boost:3}),this.field("section"),l.forEach((n,o)=>{if(typeof n.permalink>"u"||n.permalink===null){console.warn(`Documento ${o} ('${n.title||"Sem T\xEDtulo"}') n\xE3o tem permalink e n\xE3o ser\xE1 adicionado.`);return}this.add(n)})}),console.log("\xCDndice Lunr criado."),t.textContent="\xCDndice carregado. Pronto para buscar.";let a=new URLSearchParams(window.location.search).get("q");a&&(s.value=a),s.value.trim().length>0&&h()}catch(e){console.error("ERRO DETALHADO em initSearch():",e),t.textContent="Erro ao carregar a busca.",c.innerHTML='<p class="text-danger">N\xE3o foi poss\xEDvel carregar a funcionalidade de busca. Verifique o console para detalhes.</p>'}}function h(){if(!d){t.textContent="Aguarde, o \xEDndice de busca ainda est\xE1 carregando...";return}let e=s.value.trim();if(c.innerHTML="",e.length<2){t.textContent=e.length>0?"Digite pelo menos 2 caracteres.":"Digite algo para iniciar a busca.";return}t.textContent=`Buscando por "${p(e)}"...`;try{let a=e.split(/\s+/).filter(o=>o.length>0).map(o=>o+"*").join(" "),n=d.search(a);if(n.length>0){t.textContent=`${n.length} resultado(s) encontrado(s) para "${p(e)}":`;let o=document.createElement("ul");o.classList.add("list-group","list-group-flush","mt-3"),n.forEach(m=>{let r=l.find(u=>u.permalink===m.ref);if(r){let u=document.createElement("li");u.classList.add("list-group-item"),u.innerHTML=`
                            <h5 class="mb-1"><a href="${r.permalink}" class="text-decoration-none">${r.title}</a></h5>
                            <p class="mb-1 small text-muted">${r.date} ${r.section?"<em>("+r.section+")</em>":""}</p>
                            <p class="mb-1 search-summary small">${r.summary||"Sem resumo dispon\xEDvel."}</p>
                            ${r.categories&&r.categories.length>0?`<p class="mb-0 small"><strong>Categorias:</strong> ${r.categories.join(", ")}</p>`:""}
                        `,o.appendChild(u)}}),c.appendChild(o)}else t.textContent=`Nenhum resultado encontrado para "${p(e)}".`}catch(i){console.error("Erro na busca Lunr:",i),t.textContent="Ocorreu um erro ao realizar a busca.",c.innerHTML='<p class="text-danger">Ocorreu um erro durante a busca. Tente novamente.</p>'}}function p(e){return typeof e!="string"?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function g(e,i){let a;return function(...o){let m=()=>{clearTimeout(a),e(...o)};clearTimeout(a),a=setTimeout(m,i)}}s&&c&&t?(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f(),s.addEventListener("keyup",g(h,300))):console.error("Elementos da interface de busca (searchInput, searchResultsContainer, ou searchStatus) n\xE3o foram encontrados no DOM.")})();})();
